<div class="movie-app">
  <div class="container mt-4">
    @if (movie) {
    <div class="row">
      <!-- Poster -->
      <div class="col-md-4">
        <img  [src]="'https://image.tmdb.org/t/p/w500' + movie.poster_path" class="img-fluid rounded shadow poster-image"[alt]="movie.title"/>
      </div>

      <!-- Details -->
      <div class="col-md-8">
        <div class="movie-details-card">
          <div class="d-flex justify-content-between align-items-start mb-3">
            <h2>{{ movie.title }}</h2>
            <button class="heart-btn"  (click)="watchlistService.toggleWatchlist(movie)">
              <i class="bi" [ngClass]="watchlistService.isInWatchlist(movie.id) ? 'bi-heart-fill text-warning' : 'bi-heart text-secondary'"></i>
            </button>
          </div>
          
          <p class="text-muted">{{ movie.release_date | date }}</p>

          <!-- Rating -->
          <div class="mb-2">
            <span class="text-warning star-rating">
              @for (star of stars; track $index) {
              <i class="bi" [ngClass]="star ? 'bi-star-fill text-dark' : 'bi-star text-secondary'"></i>
              }
            </span>
            <span class="ms-2">{{ movie.vote_count }}</span>
          </div>

          <!-- Overview -->
          <p class="movie-overview">{{ movie.overview }}</p>

          <!-- Genres -->
          <div class="mb-3">
            @for (genre of movie.genres; track genre.id) {
            <span class="badge bg-warning text-dark me-2">{{ genre.name }}</span>
            }
          </div>

          <!-- Extra info -->
          <div class="d-flex gap-3 mt-2 mb-2">
            <!-- Duration -->
            <span><strong>Duration:</strong> {{ movie.runtime }} min</span>

            <!-- Languages -->
            <span><strong>Languages:</strong> {{ movie.original_language | uppercase }}</span>
          </div>

          <!-- Website -->
          @if (movie.homepage) {
          <a [href]="movie.homepage" target="_blank" class="btn btn-outline-dark">
            <i class="bi bi-globe"></i> Website
          </a>
          }
        </div>
      </div>
    </div>

    <!-- Recommendations Section -->
    <hr class="hr" />
  <div class="recommendations-section mt-5">
      <h4>Recommendations</h4>
    <div class="row g-3 mt-3">
        @for (rec of recommendations; track rec.id; let i = $index) { 
          @if (i < 6) {
            <div class="col-6 col-md-4 col-lg-2">
              <div class="card rec-card h-100 shadow-sm">
                <app-movie-card [movie]="rec"></app-movie-card>
              </div>
            </div>
          }
        }
      </div>
    </div>
    } 
  </div>
</div>